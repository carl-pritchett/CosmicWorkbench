<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
</meta>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
</meta>
<meta name="viewport" content="width=device-width, initial-scale=1">
</meta>
<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->


<title>Define Functional Model</title>

<!-- Bootstrap core CSS -->
<link href="css/bootstrap.min.css" rel="stylesheet"
	th:href="@{/resources/css/bootstrap.min.css}">
</link>
<!-- Bootstrap theme -->
<link href="css/bootstrap-theme.min.css"
	th:href="@{/resources/css/bootstrap-theme.min.css}" rel="stylesheet">
</link>
<link rel="stylesheet" href="css/bootstrap.vertical-tabs.css"
	th:href="@{/resources/css/bootstrap.vertical-tabs.css}">
</link>

<!-- Custom styles for this template -->
	<link href="css/theme1.css" th:href="@{/resources/css/theme1.css}"
	rel="stylesheet">
</link>

<!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
<!--[if lt IE 9]><script src="js/ie8-responsive-file-warning.js"></script><![endif]-->
<script src="js/ie-emulation-modes-warning.js"></script>


<script type="text/javascript" th:inline="javascript">
	var popUpObj;

	function showModalPopUp()

	{

		LoadModalDiv();

	}

	function showModalPopUp1(param3, param4, param5, param6, s1)

	{

		LoadModalDiv1(param3, param4, param5, param6, s1);

	}

	function LoadModalDiv()

	{

		var bcgDiv = document.getElementById("addDataGroupToModel");

		bcgDiv.style.display = "block";

	}

	function LoadModalDiv1(param3, param4, param5, param6, s1)

	{

		var bcgDiv = document.getElementById("chooseAttributes");

		bcgDiv.style.display = "block";

		document.getElementById("datagroupid").innerHTML = param3;
		
		document.getElementById("datafielddiv").innerHTML = param6;
		
	//	document.getElementById("datalist1").innerHTML = s1;

		document.getElementById("grade").value = param4;

		document.getElementById("notes").value = param5;

	}

	function HideModalDiv()

	{

		var bcgDiv = document.getElementById("addDataGroupToModel");

		bcgDiv.style.display = "none";

	}

	function HideModalDiv1()

	{

		var bcgDiv = document.getElementById("chooseAttributes");

		bcgDiv.style.display = "none";

	}
</script>


<script type="text/javascript" th:inline="javascript">
	function clickFunc(name) {

		var ctx = document.getElementById("functionalprocessname").value;

		if (ctx == '' || ctx == null) {
			alert("Name is mandatory");
			return false;
		}

		var note = document.getElementById("functionalprocessnotes").value;

		if (note == '' || note == null) {
			alert("Notes is mandatory");
			return false;
		}

		document.getElementById("option").value = name;

		document.functionalprocessform.action = "/create-new-functional-process";

		document.functionalprocessform.submit();

	}

	function popupClick(name) {

		document.getElementById("option").value = name;

		var name = document.functionalmodelform.datagroupname1.value;

		document.functionalmodelform.action = "/create-new-functional-model?datagroupname="
				+ name;
		document.functionalmodelform.submit();

	}

	function popupClick1(name) {

		document.getElementById("option").value = name;

		document.functionalmodelform.action = "/create-new-functional-model";
		document.functionalmodelform.submit();

	}

	function getFunctionalModelData(name) {
		document.getElementById("option").value = '5';
		document.functionalmodelform.method = "post";
		document.functionalmodelform.action = "/show-functional-model?functionalprocessname="
				+ name;
		document.functionalmodelform.submit();
	}

	function call() {
		showModalPopUp();

        document.systemcontextform.action = "/getdata?name="+name;
        document.systemcontextform.submit();
	}

	function getGrade(param1, param2, param3, param4, param5, param8, param9) {
		document.getElementById("functionalsubprocessid").value = param1;

		document.getElementById("datagroupname").value = param3;

		document.getElementById("functionalmodelid").value = param2;

		var datafieldlist = [[${datafieldlist}]];
		
		var i = datafieldlist.length;
		
		var j = 0;
		
		var param6 = '';
		
	//	print_r(datafieldlist);
		
		var s1 = '';
	
		for(var p in datafieldlist){ 
		
			if (datafieldlist[p].dataGroupId == param8)
				{					
				    if (param9.indexOf(datafieldlist[p].dataFieldId) == -1)
				    	{
					s1 = s1 + '<li><div class="checkbox"><label><input type="checkbox" value="';
					s1 = s1 + datafieldlist[p].dataFieldId;
					s1 = s1 + '" name="datafields">';
					s1 = s1 + datafieldlist[p].name; 
					s1 = s1 + '</input></label></div></li>';
				    	}
				    else
				    	{
				    	s1 = s1 + '<li><div class="checkbox"><label><input type="checkbox" value="';
						s1 = s1 + datafieldlist[p].dataFieldId;
						s1 = s1 + '" checked="true" name="datafields">';
						s1 = s1 + datafieldlist[p].name; 
						s1 = s1 + '</input></label></div></li>';
				    	}
					
				}
		
 
         }

        alert("s1=" + s1);
		showModalPopUp1(param3, param4, param5, param6, s1);

	}

	function openMyWindow(datagroup, subprocess)
	{
	    alert("I am opening something" + datagroup + "::" + subprocess);

        document.functionalmodelform.action = "/select-data-attributes?dg=" + datagroup + "\u0026sp=" + subprocess;
        document.functionalmodelform.submit();
	}
	
	/*
	
	function addToCheckBoxListControl(textValue, valueValue)
	{
	 var tableRef = document.getElementById("test");
	 
	 var tableRow = tableRef.insertRow();
	 var tableCell = tableRow.insertCell();
	 
	 var checkBoxRef = document.createElement('input');
	 var labelRef = document.createElement('label');
	 
	 checkBoxRef.type = 'checkbox';
	 labelRef.innerHTML = textValue;
	 checkBoxRef.value = valueValue;
	 
	 tableCell.appendChild(checkBoxRef);
	 tableCell.appendChild(labelRef);
	}
	
	*/
	//this is just a helper function I think?
	function print_r(theObj){ 
	       if(theObj.constructor == Array || theObj.constructor == Object){ 
	          document.write("<ul>");
	          for(var p in theObj){ 
	             if(theObj[p].constructor == Array || theObj[p].constructor == Object){ 
	                document.write("<li>["+p+"] => "+typeof(theObj)+"</li>"); 
	                document.write("<ul>");
	                print_r(theObj[p]); 
	                document.write("</ul>") 
	             } else { 
	                document.write("<li>["+p+"] => "+theObj[p]+"</li>"); 
	                document.write("<li>["+p+"] => "+theObj[p].dataGroupId+"</li>");
	             } 
	          } 
	          document.write("</ul>") 
	       } 
	    } 
	
</script>

<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body role="document">

	<form name="functionalmodelform" method="post" class="form-horizontal">
		<div class="container">

			<p style="color: red" th:text="*{err != null} ? ${err} : ''"></p>

			<div class="row">
				<div class="col-md-12">
					<h1>Define Functional Model</h1>
				</div>
			</div>

		</div>
		<div class="container">

			<div class="row">
				<div class="col-sm-12">

					<div style="border: #395e8a 1px solid">
						<div class="col-xs-4" style="padding-right: 0">
							<!-- required for floating -->
							<!-- Nav tabs -->
							<ul class="nav nav-tabs tabs-left"
								th:each="functionalprocesstmp : ${functionalprocesslist}">

								<li th:class="*{functionalprocesstmp.functionalProcessId == session.functionalprocessname} ? 'active' : ''">
									<a href="#" data-toggle="tab"
									th:text="${functionalprocesstmp.name}"
									   th:onclick="'javascript:getFunctionalModelData(\'' +${functionalprocesstmp.functionalProcessId} + '\');'"></a>
								</li>


							</ul>
						</div>

						<input type="hidden" id="option" name="option"> </input> <input type="hidden" id="functionalsubprocessid" name="functionalsubprocessid"> </input>
						<input type="hidden" id="datagroupname" name="datagroupname"> </input>
						<input type="hidden" id="functionalmodelid" name="functionalmodelid"> </input>

						<div class="col-xs-8 bluebg">
							<!-- Tab panes -->
							<div class="tab-content">
								<div class="tab-pane active" id="data1"
									style="padding: 25px 5px;">


									<div class="table-responsive">


										<table class="table table-bordered">
											<thead>
												<tr>
													<th></th>
                                                    <th width="40%" th:each="functionalmodel : ${distinctfunctionalmodellist}">
														<div th:text="${functionalmodel.dataGroupName}"></div>
													</th>
													<th>
                                                        <button type="button" class="btn btn-default" onclick="call()">+</button>
													</th>
												</tr>


											</thead>
											<tbody>

												<tr
													th:each="functionalsubprocess : ${functionalsubprocesslist}">
													<td th:text="${functionalsubprocess.name}"></td>
                                                    <!--<td-->
                                                    <!--th:each="functionalmodel : ${functionalsubprocess.functionalModel}"-->
                                                    <!--th:onclick="'javascript:getGrade(' +${functionalmodel.functionalSubProcessId} + ',' + ${functionalmodel.functionalModelId} + ',\'' + ${functionalmodel.displaydataGroupName} + '\',\'' + ${functionalmodel.grade} + '\',\'' + ${functionalmodel.notes} + '\',' + ${functionalmodel.dataGroupId} + ',\'' + ${functionalmodel.datafieldList} + '\');'"-->
                                                    <!--th:text="*{functionalmodel.grade != null} ? ${functionalmodel.grade} : ' '" ></td>-->
                                                    <td th:each="functionalmodel : ${functionalsubprocess.functionalModel}"
                                                        th:onclick="'javascript:openMyWindow( ' + ${functionalmodel.dataGroupId} + ',' + ${functionalsubprocess.functionalSubProcessId} + ');'"
                                                        th:text="*{functionalmodel.grade != null} ? ${functionalmodel.grade} : ' '">
                                                    </td>

                                                </tr>
												<tr>
													<td th:text="${finalScore}"></td>
													<td th:each="score : ${scores}" th:text="${score.score}"></td>
												</tr>



											</tbody>
										</table>



									</div>


								</div>
							</div>
						</div>
						<div class="clearfix"></div>
					</div>
					<div class="clearfix"></div>

				</div>

				`
			</div>

		</div>
		<!-- /container -->

		<div id="addDataGroupToModel"
			 style="position: fixed; z-index: 999; height: 100%; width: 100%; top: 0; left: 0; background-color: Black; filter: alpha(opacity =                                                                                         100); opacity: 1.0; -moz-opacity: 0.8; display: none">

			<div class="container">

				<p style="color: red" th:text="*{err != null} ? ${err} : ''"></p>
				<div class="row">
					<div class="col-md-12">
						<div id="bkg_div">

							<div class="form-group">
                                <label for="inputEmail3" class="col-sm-4 control-label">Data Group: :</label>
								<div class="col-sm-8">
									<select name="datagroupname1" class="form-control">
                                        <option th:each="datagroup : ${datagrouplist}" th:value="${datagroup.name}" th:text="${datagroup.name}"></option>
									</select>
								</div>
							</div>
							<input type="hidden" id="option" name="option"> </input>
							<div class="form-group" style="padding-top: 20px;">
								<div class="col-sm-offset-4 col-sm-8">

                                    <button class="btn btn-default" type="submit" th:onclick="'javascript:popupClick(\'addDataGroupToModel\');'">Save</button>
                                    <button class="btn btn-danger" type="submit" th:onclick="'javascript:popupClick(0);'">Delete
									</button>

								</div>
							</div>

						</div>
					</div>
				</div>
			</div>


		</div>

        <div id="chooseAttributes"
			 style="position: fixed; z-index: 999; height: 100%; width: 100%; top: 0; left: 0; background-color: Black; filter: alpha(opacity =                                                                                         100); opacity: 1.0; -moz-opacity: 0.8; display: none">

			<div class="container">
				<div class="row">
					<div class="col-md-12">
						<div id="bkg_div">

							<div class="form-group">
								<label for="grade" class="col-sm-4 control-label">Type :</label>
								<div class="col-sm-8">
									<select name="grade" id="grade" class="form-control">
                                        <option th:value="E" th:text="'Entry'"></option>
                                        <option th:value="X" th:text="'Exit'"></option>
                                        <option th:value="R" th:text="'Read'"></option>
                                        <option th:value="W" th:text="'Write'"></option>
									</select>
								</div>
							</div>
							<div class="form-group">
                                <label for="notes" class="col-sm-4 control-label">Notes:</label>
								<div class="col-sm-8">
									<textarea name="notes" id="notes" rows="2" class="form-control"></textarea>
								</div>
							</div>
							<div class="form-group">
								<label for="inputPassword3" class="col-sm-4 control-label">
									<div id="datagroupid"></div>
								</label>

								<div class="col-sm-8" id="datafielddiv"></div>
								<div class="col-sm-8">
                                        <ul class="datamodellist"
                                            th:each="datafield : ${datafieldlist}">
                                            <li><div class="checkbox">
                                                <label>
                                                    <input type="checkbox" th:value="${datafield.dataFieldId}" name="datafields" th:text="${datafield.name}"> </input>
                                                    </label>
                                                </div></li>
                                        </ul>
									<ul class="datamodellist" id="datalist1">


									</ul>


								</div>
							</div>

							<div class="form-group" style="padding-top: 20px;">
								<div class="col-sm-offset-4 col-sm-8">

                                    <button class="btn btn-default" type="submit" th:onclick="'javascript:popupClick1(\'saveNewAttributes\');'">Save</button>
                                    <button class="btn btn-danger" type="submit" th:onclick="'javascript:popupClick1(2);'">Delete</button>

								</div>
							</div>



						</div>
					</div>
				</div>
			</div>


		</div>

	</form>

	<!-- Bootstrap core JavaScript
    ================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/docs.min.js"></script>
	<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
	<script src="js/ie10-viewport-bug-workaround.js"></script>
</body>
</html>
